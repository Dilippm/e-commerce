<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content
        must come *after* these tags -->

    <title>Electro - Ecommerce
    </title>

    <!-- Google font -->
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,500,700" rel="stylesheet">

    <!-- Bootstrap -->
    <link type="text/css" rel="stylesheet" href="/css/bootstrap.min.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
        crossorigin="anonymous"></script>

    <!-- Slick -->
    <link type="text/css" rel="stylesheet" href="/css/slick.css" />
    <link type="text/css" rel="stylesheet" href="/css/slick-theme.css" />

    <!-- nouislider -->
    <link type="text/css" rel="stylesheet" href="/css/nouislider.min.css" />

    <!-- Font Awesome Icon -->
    <link rel="stylesheet" href="/css/font-awesome.min.css">

    <!-- Custom stlylesheet -->
    <link type="text/css" rel="stylesheet" href="/css/style.css" />

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

</head>

<body>

    <%- include('../layout/user/navbar.ejs')%>

        <!-- Menu Toogle -->
        <div class="menu-toggle">
            <a href="#">
                <i class="fa fa-bars"></i>
                <span>Menu</span>
            </a>
        </div>
        <!-- /Menu Toogle -->
        </div>
        </div>
        <!-- /ACCOUNT -->
        </div>
        <!-- row -->
        </div>
        <!-- container -->
        </div>
        <!-- /MAIN HEADER -->
        </header>
        <!-- /HEADER -->

        <!-- NAVIGATION -->
        <nav id="navigation">
            <!-- container -->
            <div class="container">
                <!-- responsive-nav -->
                <div id="responsive-nav">
                    <!-- NAV -->
                    <ul class="main-nav nav navbar-nav" style="display: flex; flex-direction: row; font-size: large;">
                        <li class="active">
                            <a href="/" style="text-decoration: none;">Home</a>
                        </li>
                        <li class="active">
                            <a href="/products" style="text-decoration: none;">All Products</a>
                        </li>

                    </ul>
                    <!-- /NAV -->
                </div>
                <!-- /responsive-nav -->
            </div>
            <!-- /container -->
        </nav>
        <!-- /NAVIGATION -->
        <div class="container">
            <div id="carouselExample" class="carousel slide">
                <div class="carousel-inner" style="border: 1px solid black;">
                    <% banners.forEach((element, index)=> { %>
                        <div class="carousel-item <%= index === 0 ? 'active' : '' %>">
                            <img style="height: 500px;" class="d-block w-100"
                                src="/productImages/<%= element.image[0] %>" alt="Slide <%= index %>">
                            <div class="carousel-caption d-md-block">
                                <!-- Add your caption content here -->
                            </div>
                        </div>
                        <% }) %>

                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#carouselExample"
                    data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Previous</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#carouselExample"
                    data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Next</span>
                </button>
            </div>

        </div>

        <!-- SECTION -->
        <div class="section">
            <!-- container -->
            <div class="container">
                <!-- row -->
                <div class="row">

                    <!-- section title -->
                    <div class="col-md-12">
                        <div class="section-title">
                            <h3 class="title">Products</h3>

                        </div>
                    </div>
                    <!-- /section title -->

                    <!-- Products tab & slick -->
                    <div class="col-md-12">
                        <div class="row">
                            <div class="products-tabs">
                                <!-- tab -->
                                <div id="tab1" class="tab-pane active">
                                    <div class="products-slick" data-nav="#slick-nav-1">
                                        <!-- product -->
                                        <% data.forEach((data)=>{%>
                                            <div class="product">
                                                <div class="product-img">
                                                    <img src="/productImages/<%- data.images[0]%>" alt="">
                                                    <div class="product-label">
                                                        <% if (data.offers && data.offers[0] && data.offers[0].discount>
                                                            0) { %>
                                                            <span class="new">
                                                                <b>
                                                                    <%= data.offers[0].discount %>% OFF
                                                                </b>
                                                            </span>
                                                            <% } %>
                                                    </div>

                                                </div>
                                                <div class="product-body">

                                                    <h3 class="product-name">
                                                        <a href="/productview/<%= data._id %>">
                                                            <%- data.productName %>
                                                        </a>
                                                    </h3>
                                                    <h4 class="product-price">
                                                        ₹.<%= data.price %>/-

                                                    </h4>

                                                    <div class="product-rating">
                                                        <i class="fa fa-star"></i>
                                                        <i class="fa fa-star"></i>
                                                        <i class="fa fa-star"></i>
                                                        <i class="fa fa-star"></i>
                                                        <i class="fa fa-star"></i>
                                                    </div>
                                                    <div class="product-btns">
                                                        <button class="add-to-wishlist"
                                                            onclick="addtoWishlist('<%= data._id %>')">
                                                            <i class="fa fa-heart-o"></i>
                                                            <span class="tooltipp">Add to Wishlist</span>
                                                        </button>

                                                    </div>
                                                </div>
                                                <div class="add-to-cart" onclick="addToCart('<%= data._id %>')">
                                                    <button class="add-to-cart-btn">
                                                        <i class="fa fa-shopping-cart"></i>
                                                        <i class="fa fa-shopping-cart"></i>
                                                        Add to cart
                                                    </button>

                                                </div>
                                            </div>
                                            <% }) %>

                                                <!-- /product -->

                                    </div>
                                    <div id="slick-nav-1" class="products-slick-nav"></div>
                                </div>
                                <!-- /tab -->
                            </div>
                        </div>
                    </div>
                    <!-- Products tab & slick -->
                </div>
                <!-- /row -->
            </div>
            <!-- /container -->
        </div>
        <!-- /SECTION -->
        <!-- HOT DEAL SECTION -->
        <div id="hot-deal" class="section">
            <!-- container -->
            <div class="container">
                <!-- row -->
                <div class="row">
                    <div class="col-md-12">
                        <div class="hot-deal">
                            <ul class="hot-deal-countdown"></ul>
                            <h2 class="text-uppercase">View Products</h2>

                            <a class="primary-btn cta-btn" href="/products">Shop now</a>
                        </div>
                    </div>
                </div>
                <!-- /row -->
            </div>
            <!-- /container -->
        </div>
        <!-- /HOT DEAL SECTION -->

        <!-- SECTION -->
        <div class="section">
            <!-- container -->
            <div class="container">
                <!-- row -->
                <div class="row">

                    <!-- section title -->
                    <div class="col-md-12">
                        <div class="section-title">
                            <h3 class="title">Top selling</h3>
                            <div class="section-nav"></div>
                        </div>
                    </div>
                    <!-- /section title -->

                    <!-- Products tab & slick -->
                    <div class="col-md-12">
                        <div class="row">
                            <div class="products-tabs">
                                <!-- tab -->
                                <div id="tab2" class="tab-pane fade in active">
                                    <div class="products-slick" data-nav="#slick-nav-2">
                                        <% topSellingProducts.forEach((data)=>{%>
                                            <div class="product">
                                                <div class="product-img">
                                                    <img src="/productImages/<%- data.product.images[0]%>" alt="">
                                                    <div class="product-label">
                                                        <% if (data.product.offers && data.product.offers[0] &&
                                                            data.product.offers[0].discount> 0) { %>
                                                            <span class="new">
                                                                <b>
                                                                    <%= data.product.offers[0].discount %>% OFF
                                                                </b>
                                                            </span>
                                                            <% } %>
                                                    </div>

                                                </div>
                                                <div class="product-body">

                                                    <h3 class="product-name">
                                                        <a href="/productview/<%= data.product._id %>">
                                                            <%- data.product.productName %>
                                                        </a>
                                                    </h3>
                                                    <h4 class="product-price">
                                                        ₹.<%= data.product.price %>/-

                                                    </h4>

                                                    <div class="product-rating">
                                                        <i class="fa fa-star"></i>
                                                        <i class="fa fa-star"></i>
                                                        <i class="fa fa-star"></i>
                                                        <i class="fa fa-star"></i>
                                                        <i class="fa fa-star"></i>
                                                    </div>
                                                    <div class="product-btns">
                                                        <button class="add-to-wishlist"
                                                            onclick="addtoWishlist('<%= data.product._id %>')">
                                                            <i class="fa fa-heart-o"></i>
                                                            <span class="tooltipp">Add to Wishlist</span>
                                                        </button>

                                                    </div>
                                                </div>
                                                <div class="add-to-cart" onclick="addToCart('<%= data.product._id %>')">
                                                    <button class="add-to-cart-btn">
                                                        <i class="fa fa-shopping-cart"></i>
                                                        <i class="fa fa-shopping-cart"></i>
                                                        Add to cart
                                                    </button>

                                                </div>
                                            </div>
                                            <% }) %>

                                    </div>
                                    <div id="slick-nav-2" class="products-slick-nav"></div>
                                </div>
                                <!-- /tab -->
                            </div>
                        </div>
                    </div>
                    <!-- /Products tab & slick -->
                </div>
                <!-- /row -->
            </div>
            <!-- /container -->
        </div>
        <!-- /SECTION -->
        <!-- SECTION -->
        <div class="section">
            <!-- container -->
            <div class="container">
                <!-- row -->
                <div class="row">

                    <!-- section title -->
                    <div class="col-md-12">
                        <div class="section-title">
                            <h3 class="title">Offer Products</h3>
                        </div>
                    </div>
                    <!-- /section title -->

                    <!-- Products tab & slick -->
                    <div class="col-md-12">
                        <div class="row">
                            <div class="products-tabs">
                                <% if(data.filter(item=> item.offers && item.offers[0] && item.offers[0].discount >
                                    0).length > 0) { %>
                                    <!-- tab -->
                                    <div id="tab1" class="tab-pane active">
                                        <div class="products-slick" data-nav="#slick-nav-1">
                                            <!-- product -->
                                            <% data.filter(item=> item.offers && item.offers[0] &&
                                                item.offers[0].discount > 0).forEach((data)=>{%>
                                                <div class="product">
                                                    <div class="product-img">
                                                        <img src="/productImages/<%- data.images[0]%>" alt="">
                                                        <div class="product-label">
                                                            <% if (data.offers && data.offers[0] &&
                                                                data.offers[0].discount> 0) { %>
                                                                <span class="new">
                                                                    <b>
                                                                        <%= data.offers[0].discount %>% OFF
                                                                    </b>
                                                                </span>
                                                                <% } %>
                                                        </div>
                                                    </div>
                                                    <div class="product-body">
                                                        <h3 class="product-name">
                                                            <a href="/productview/<%= data._id %>">
                                                                <%- data.productName %>
                                                            </a>
                                                        </h3>
                                                        <h4 class="product-price">
                                                            ₹.<%= data.price %>/-
                                                        </h4>
                                                        <div class="product-rating">
                                                            <i class="fa fa-star"></i>
                                                            <i class="fa fa-star"></i>
                                                            <i class="fa fa-star"></i>
                                                            <i class="fa fa-star"></i>
                                                            <i class="fa fa-star"></i>
                                                        </div>
                                                        <div class="product-btns">
                                                            <button class="add-to-wishlist"
                                                                onclick="addtoWishlist('<%= data._id %>')">
                                                                <i class="fa fa-heart-o"></i>
                                                                <span class="tooltipp">Add to Wishlist</span>
                                                            </button>
                                                        </div>
                                                    </div>
                                                    <div class="add-to-cart" onclick="addToCart('<%= data._id %>')">
                                                        <button class="add-to-cart-btn">
                                                            <i class="fa fa-shopping-cart"></i>
                                                            <i class="fa fa-shopping-cart"></i>
                                                            Add to cart
                                                        </button>
                                                    </div>
                                                </div>
                                                <% }) %>
                                                    <!-- /product -->
                                        </div>
                                        <div id="slick-nav-1" class="products-slick-nav"></div>
                                    </div>
                                    <% } else { %>
                                        <div class="col-md-12">
                                            <h4>No products with offer available currently</h4>
                                        </div>
                                        <% } %>
                                            <!-- /tab -->
                            </div>
                        </div>
                    </div>
                    <!-- Products tab & slick -->
                    <!-- FOOTER -->
                    <footer id="footer">
                        <!-- top footer -->
                        <div class="section">
                            <!-- container -->
                            <div class="container-fluid" style="margin: 0;">
                                <!-- row -->
                                <div class="row">
                                    <div class="col-md-3 col-xs-6">
                                        <div class="footer">
                                            <h3 class="footer-title">About Us</h3>
                                            <p>We sell the best!!!</p>
                                            <ul class="footer-links">
                                                <li>
                                                    <a href="#">
                                                        <i class="fa fa-map-marker"></i>Kakkanchery, Malappuram</a>
                                                </li>
                                                <li>
                                                    <a href="#">
                                                        <i class="fa fa-phone"></i>9990009900</a>
                                                </li>
                                                <li>
                                                    <a href="#">
                                                        <i class="fa fa-envelope-o"></i>electro@gmail.com</a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>

                                    <div class="col-md-3 col-xs-6">
                                        <div class="footer">
                                            <h3 class="footer-title">Categories</h3>
                                            <ul class="footer-links">

                                                <li>
                                                    <a href="/products">Laptops</a>
                                                </li>
                                                <li>
                                                    <a href="/products">Smartphones</a>
                                                </li>

                                            </ul>
                                        </div>
                                    </div>

                                    <div class="clearfix visible-xs"></div>

                                    <div class="col-md-3 col-xs-6">
                                        <div class="footer">
                                            <h3 class="footer-title">Information</h3>
                                            <ul class="footer-links">
                                                <li>
                                                    <a href="#">About Us</a>
                                                </li>
                                                <li>
                                                    <a href="#">Contact Us</a>
                                                </li>
                                                <li>
                                                    <a href="#">Privacy Policy</a>
                                                </li>
                                                <li>
                                                    <a href="/orderlist">Orders and Returns</a>
                                                </li>
                                                <li>
                                                    <a href="#">Terms & Conditions</a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>

                                    <div class="col-md-3 col-xs-6">
                                        <div class="footer">
                                            <h3 class="footer-title">Service</h3>
                                            <ul class="footer-links">
                                                <li>
                                                    <a href="/profile">My Account</a>
                                                </li>
                                                <li>
                                                    <a href="/cart">View Cart</a>
                                                </li>
                                                <li>
                                                    <a href="/wishlist">Wishlist</a>
                                                </li>
                                                <li>
                                                    <a href="/orderlist">Track My Order</a>
                                                </li>

                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                <!-- /row -->
                            </div>
                            <!-- /container -->
                        </div>
                        <!-- /top footer -->

                    </footer>
                    <!-- /FOOTER -->

                    <script>
                        function addtoWishlist(proId) {
                            console.log(proId);
                            $.ajax({
                                url: '/addWishlist/' + proId, // replace with the URL of your server-side script
                                type: 'get', // use POST method

                                success: (response) => {
                                    console.log(response);
                                    if (response.done) {
                                        Swal.fire(
                                            { position: 'top-end', icon: 'success', title: 'Added to Whishlist', showConfirmButton: false, timer: 3000 }
                                        )
                                    } else if (response.exist) {
                                        Swal.fire(
                                            { position: 'top-end', title: 'Already in Wishlist', showConfirmButton: false, timer: 3000 }
                                        )
                                    } else {
                                        location.href = '/login'
                                    }

                                }
                            })
                        }

                        function addToCart(proId) {
                            console.log(proId);
                            $.ajax({
                                url: '/add-to-cart/' + proId, // replace with the URL of your server-side script
                                type: 'get', // use POST method

                                success: (response) => {
                                    console.log(response);
                                    if (response.done) {
                                        Swal.fire(
                                            { position: 'top-end', icon: 'success', title: 'Added to Cart', showConfirmButton: false, timer: 1500 }
                                        )
                                    } else if (response.exist) {
                                        Swal.fire(
                                            { position: 'top-end', title: 'Already in Cart', showConfirmButton: false, timer: 1500 }
                                        )
                                    } else {
                                        location.href = '/login'
                                    }

                                }
                            })
                        }
                    </script>

                    <%- include('../layout/user/footer.ejs')%>